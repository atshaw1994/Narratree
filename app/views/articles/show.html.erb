<div class="article-btn-container">
  <button type="button" class="user-interaction-btn" id="toggle-comments-btn" title="Toggle Comments">
    <span class="material-symbols-rounded">message</span>
  </button>
  
  <% if current_user %>
    <!-- Like button does not have functionality yet -->
    <%= button_to "#", class: "user-interaction-btn", title: "Like Article" do %>
        <span class="material-symbols-rounded">thumb_up</span>
    <% end %>
    <!-- Share button does not have functionality yet -->
    <%= button_to "#", class: "user-interaction-btn", title: "Share Article" do %>
        <span class="material-symbols-rounded">share</span>
    <% end %>

    <!-- Only allow editing/deleting if user is the original author -->
    <% if @article.user == current_user %>
      <%= link_to edit_article_path(@article), class: "user-interaction-btn", title: "Edit Article" do %>
        <span class="material-symbols-rounded">edit</span>
      <% end %>
      <%= link_to article_path(@article), class: "user-interaction-btn delete-btn", title: "Delete Article", data: {
        turbo_method: :delete, turbo_confirm: "Are you sure?" } do %>
        <span class="material-symbols-rounded">delete</span>
      <% end %>
    <% end %>
  <% end %>
</div>

<div class="article-title">
  <h1><%= @article.title %></h1>
  <p><em>Written by <%= @article.user&.username || 'Unknown' %></em></p>
</div>

<div class="article-body">
  <p><%= @article.body %></p>
</div>

<%# style="display:none;" %>
<div class="comments-section" id="comments-section" >
  <%= render "comments/form", article: @article, comment: @comment %>
  <%= render @article.comments.select(&:body) %>
</div>
<%= javascript_tag do %>
  document.addEventListener("turbo:load", function() {
    var btn = document.getElementById("toggle-comments-btn");
    var section = document.getElementById("comments-section");
    if (btn && section) {
      btn.addEventListener("click", function() {
        if (section.style.display === "none") {
          section.style.display = "";
        } else {
          section.style.display = "none";
        }
      });
    }
  });
<% end %>
