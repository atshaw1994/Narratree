<%= javascript_include_tag 'admin_user_roles' %>
<div class="section-container" style="max-width: 95%;" data-controller="admin-tabs">
    <div class="section-container-header">
        <h2 style="width: 16rem;">Admin Dashboard</h2>
        <div style="display: flex; align-items: center; gap: 1em; width: 100%;">
            <div class="admin-tab-header-flex" style="display: flex; align-items: center; justify-content: space-between; gap: 1em; max-height: 70vh;">
                <div class="admin-tab-buttons" style="display: flex; gap: 0.5em;">
                    <button type="button" class="admin-tab-btn active" data-admin-tabs-target="tabBtn" data-tab="users" data-action="click->admin-tabs#switch">Users</button>
                    <button type="button" class="admin-tab-btn" data-admin-tabs-target="tabBtn" data-tab="articles" data-action="click->admin-tabs#switch">Articles</button>
                    <button type="button" class="admin-tab-btn" data-admin-tabs-target="tabBtn" data-tab="tickerbar" data-action="click->admin-tabs#switch">TickerBar</button>
                </div>
            </div>
            <div class="search-bar-container" style="flex-grow: 1;">
                <%= text_field_tag :admin_query, params[:admin_query],
                    placeholder: "Search users, articles, authors...",
                    class: "search-input",
                    data: { action: "input->admin-tabs#search", admin_tabs_target: "searchInput" }
                %>
            </div>
        </div>
    </div>
    <div class="section-container-body">
        <div id="admin-tabs" style="width: 100%;">
            <div class="admin-tab-content" id="users-tab" data-admin-tabs-target="tabContent" style="display: block;">
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>Picture</th>
                            <th data-action="click->admin-tabs#sort" data-admin-tabs-column="user-id"><span>User Id</span><span class="sort-arrow" data-admin-tabs-target="userIdArrow"></span></th>
                            <th data-action="click->admin-tabs#sort" data-admin-tabs-column="username"><span>Username</span><span class="sort-arrow" data-admin-tabs-target="usernameArrow"></span></th>
                            <th data-action="click->admin-tabs#sort" data-admin-tabs-column="first-name"><span>First Name</span><span class="sort-arrow" data-admin-tabs-target="firstNameArrow"></span></th>
                            <th data-action="click->admin-tabs#sort" data-admin-tabs-column="last-name"><span>Last Name</span><span class="sort-arrow" data-admin-tabs-target="lastNameArrow"></span></th>
                            <th data-action="click->admin-tabs#sort" data-admin-tabs-column="created-at"><span>Created At</span><span class="sort-arrow" data-admin-tabs-target="createdAtArrow"></span></th>
                            <th data-action="click->admin-tabs#sort" data-admin-tabs-column="updated-at"><span>Updated At</span><span class="sort-arrow" data-admin-tabs-target="updatedAtArrow"></span></th>
                            <th data-action="click->admin-tabs#sort" data-admin-tabs-column="encrypted-password"><span>Encrypted Password</span><span class="sort-arrow" data-admin-tabs-target="encryptedPasswordArrow"></span></th>
                            <th data-action="click->admin-tabs#sort" data-admin-tabs-column="warnings"><span>Warnings</span><span class="sort-arrow" data-admin-tabs-target="warningsArrow"></span></th>
                            <th data-action="click->admin-tabs#sort" data-admin-tabs-column="role"><span>Role</span><span class="sort-arrow" data-admin-tabs-target="roleArrow"></span></th>
                            <th>Approved</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% User.all.each do |user| %>
                          <%= render partial: 'user_row', locals: { user: user, current_user: current_user } %>
                        <% end %>
                    </tbody>
                </table>
            </div>
            <div class="admin-tab-content" id="articles-tab" data-admin-tabs-target="tabContent" style="display: none;">
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th data-action="click->admin-tabs#sort" data-admin-tabs-column="article-id"><span>Article Id</span><span class="sort-arrow" data-admin-tabs-target="articleIdArrow"></span></th>
                            <th data-action="click->admin-tabs#sort" data-admin-tabs-column="title"><span>Title</span><span class="sort-arrow" data-admin-tabs-target="titleArrow"></span></th>
                            <th data-action="click->admin-tabs#sort" data-admin-tabs-column="author"><span>Author</span><span class="sort-arrow" data-admin-tabs-target="authorArrow"></span></th>
                            <th data-action="click->admin-tabs#sort" data-admin-tabs-column="created-at"><span>Created At</span><span class="sort-arrow" data-admin-tabs-target="createdAtArrow"></span></th>
                            <th data-action="click->admin-tabs#sort" data-admin-tabs-column="updated-at"><span>Updated At</span><span class="sort-arrow" data-admin-tabs-target="updatedAtArrow"></span></th>
                            <th data-action="click->admin-tabs#sort" data-admin-tabs-column="comments"><span>Comments</span><span class="sort-arrow" data-admin-tabs-target="commentsArrow"></span></th>
                            <th data-action="click->admin-tabs#sort" data-admin-tabs-column="photos"><span>Photos</span><span class="sort-arrow" data-admin-tabs-target="photosArrow"></span></th>
                            <th data-action="click->admin-tabs#sort" data-admin-tabs-column="likes"><span>Likes</span><span class="sort-arrow" data-admin-tabs-target="likesArrow"></span></th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% Article.all.each do |article| %>
                            <%= render partial: 'article_row', locals: { article: article } %>
                        <% end %>
                    </tbody>
                </table>
            </div>
            <div class="admin-tab-content" id="tickerbar-tab" data-admin-tabs-target="tabContent" style="display: none;">
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th data-action="click->admin-tabs#sort" data-admin-tabs-column="ticker-id"><span>Ticker Id</span><span class="sort-arrow" data-admin-tabs-target="tickerIdArrow"></span></th>
                            <th data-action="click->admin-tabs#sort" data-admin-tabs-column="message"><span>Message</span><span class="sort-arrow" data-admin-tabs-target="messageArrow"></span></th>
                            <th data-action="click->admin-tabs#sort" data-admin-tabs-column="created-at"><span>Created At</span><span class="sort-arrow" data-admin-tabs-target="createdAtArrow"></span></th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% TickerMessage.all.each do |ticker_message| %>
                            <%= render partial: 'ticker_message_row', locals: { ticker_message: ticker_message } %>
                        <% end %>
                        <tr>
                            <td colspan="4">
                                <%= form_with model: TickerMessage.new, url: ticker_messages_path, local: true, html: { data: { controller: "ticker-message-form" } } do |form| %>
                                    <div style="display: flex; gap: 0.5em; align-items: center;">
                                        <%= form.text_field :message, placeholder: "New ticker message", required: true, style: "flex-grow: 1;", class: "search-input", data: { ticker_message_form_target: "input", action: "input->ticker-message-form#inputChanged" } %>
                                        <%= form.button type: "submit", class: "admin-add-button", data: { ticker_message_form_target: "button" } do %>
                                            <span class="material-symbols-rounded" style="font-size: 20px; color: #fff;">check</span>
                                        <% end %>
                                    </div>
                                <% end %>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
