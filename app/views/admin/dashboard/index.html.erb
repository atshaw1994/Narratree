<div class="section-container">
    <div class="section-container-header">
        <h2>Admin Dashboard</h2>
    </div>
    <div class="section-container-body">
        <div id="admin-tabs" data-controller="admin-tabs">
            <div class="admin-tab-buttons">
                <button type="button" class="admin-tab-btn active" data-admin-tabs-target="tabBtn" data-tab="users" data-action="click->admin-tabs#switch">Users</button>
                <button type="button" class="admin-tab-btn" data-admin-tabs-target="tabBtn" data-tab="articles" data-action="click->admin-tabs#switch">Articles</button>
            </div>
            <div class="admin-tab-content" id="users-tab" data-admin-tabs-target="tabContent" style="display: block;">
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>Picture</th>
                            <th>User Id</th>
                            <th>Username</th>
                            <th>First Name</th>
                            <th>Last Name</th>
                            <th>Created At</th>
                            <th>Updated At</th>
                            <th>Encrypted Password</th>
                            <th>Role</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% User.all.each do |user| %>
                            <tr>
                                <td>
                                    <% if user.profile_picture.attached? %>
                                        <%= image_tag user.profile_picture, class: "profile-pic-small" %>
                                    <% else %>
                                        <span class="material-symbols-rounded default-user-icon">account_circle</span>
                                    <% end %>
                                </td>
                                <td><%= user.id %></td>
                                <td><%= link_to user.username, user_path(user) %></td>
                                <td><%= user.first_name %></td>
                                <td><%= user.last_name %></td>
                                <td><%= user.created_at %></td>
                                <td><%= user.updated_at %></td>
                                <td><%= user.encrypted_password.present? ? "Set" : "Unset" %></td>
                                <td><%= user.admin? ? "Admin" : "User" %></td>
                                <td>
                                    <%= link_to 'Delete', user_path(user), method: :delete, data: { confirm: 'Are you sure you want to delete this user?' }, class: 'btn btn-sm btn-danger' %>
                                </td>
                            </tr>
                        <% end %>
                    </tbody>
                </table>
            </div>
            <div class="admin-tab-content" id="articles-tab" data-admin-tabs-target="tabContent" style="display: none;">
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>Article Id</th>
                            <th>Title</th>
                            <th>Author</th>
                            <th>Created At</th>
                            <th>Updated At</th>
                            <th>Comments</th>
                            <th>Photos</th>
                            <th>Likes</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% Article.all.each do |article| %>
                            <tr>
                                <td><%= article.id %></td>
                                <td><%= link_to article.title, article_path(article) %></td>
                                <td><%= article.user.username %></td>
                                <td><%= article.created_at %></td>
                                <td><%= article.updated_at %></td>
                                <td><%= article.comments.count %></td>
                                <td><%= article.photos.attached? ? article.photos.count : 0 %></td>
                                <td><%= article.article_likes.count %></td>
                                <td>
                                  <%= link_to 'Edit', edit_article_path(article), class: 'btn btn-sm btn-primary', style: 'margin-right: 0.5em;' %>
                                  <%= link_to 'Delete', article_path(article), method: :delete, data: { confirm: 'Are you sure?' }, class: 'btn btn-sm btn-danger' %>
                                </td>
                            </tr>
                        <% end %>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
